pragma circom 2.0.2;

include "../node_modules/circomlib/circuits/comparators.circom";
include "../node_modules/circomlib/circuits/switcher.circom";

template ArgMax (n) {
    signal input in[n];
    signal output out;
    component gts[n];        // store comparators
    component switchers[n+1];  // switcher for comparing maxs
    component aswitchers[n+1]; // switcher for arg max

    signal maxs[n+1];
    signal amaxs[n+1];

    maxs[0] <== in[0];
    amaxs[0] <== 0;
    for(var i = 0; i < n; i++) {
        gts[i] = GreaterThan(30);
        switchers[i+1] = Switcher();
        aswitchers[i+1] = Switcher();

        gts[i].in[1] <== maxs[i];
        gts[i].in[0] <== in[i];

        switchers[i+1].sel <== gts[i].out;
        switchers[i+1].L <== maxs[i];
        switchers[i+1].R <== in[i];
        
        aswitchers[i+1].sel <== gts[i].out;
        aswitchers[i+1].L <== amaxs[i];
        aswitchers[i+1].R <== i;
        amaxs[i+1] <== aswitchers[i+1].outL;
        maxs[i+1] <== switchers[i+1].outL;
    }

    out <== amaxs[n];
}

// image is non-negative 50x1 shape matrix, output from prior NN layers 
// A is final layer of NN, ndigitsx50 shape matrix
template DigitReader (n) {
    signal input image[n]; // must be non-negative
    signal output digit;
    var ndigits = 10;
    var A[ndigits][n] = [[0, 13, 75, 45, 53, 21, 4, 67, 67, 93, 38, 51, 83, 4, 5, 52, 67, 0, 38, 6, 41, 68, 58, 93, 84, 52, 9, 65, 41, 70, 91, 76, 26, 4, 75, 34, 63, 74, 102, 48, 40, 113, 76, 75, 67, 10, 61, 84, 23, 39, 75, 48, 23, 27, 35, 16, 48, 89, 90, 7, 91, 44, 46, 18, 67, -6, -25, -14, 68, -11, 2, -98, -162, -199, -249, -211, -99, -105, 15, 53, 74, 10, 1, 68, 86, 62, 73, 69, 95, 67, -8, -25, -89, -107, -109, -116, -146, -135, -294, -451, -581, -737, -742, -699, -512, -297, -148, -94, 9, 44, 93, 74, 55, 89, 61, 79, -9, -62, -78, -269, -429, -540, -602, -424, -174, 115, 272, 152, 70, 21, 27, -27, -185, -149, -211, -180, -129, -55, 47, 84, 59, 95, 51, 8, 45, -103, -233, -328, -470, -525, -436, -242, 20, 394, 583, 629, 505, 431, 315, 154, -33, -190, -360, -466, -490, -138, -8, 11, 94, 40, 7, 83, -39, -97, -211, -200, -317, -332, -129, 48, 212, 458, 630, 734, 632, 535, 453, 323, 22, -198, -396, -540, -756, -371, -44, 36, 95, 61, 40, 59, -37, -78, -87, -114, -7, -90, -27, 72, 272, 507, 761, 811, 801, 856, 737, 441, 73, -335, -570, -681, -910, -607, -133, -3, 75, 47, 40, -13, -183, -180, -114, -51, -64, -229, -139, -3, 227, 532, 710, 828, 934, 1000, 886, 638, 329, 16, -229, -412, -802, -652, -167, -8, 77, 68, -10, -91, -215, -246, -185, -2, -48, 8, 38, 259, 492, 558, 594, 801, 965, 881, 1064, 959, 646, 545, 311, 163, -394, -498, -112, 18, 19, -5, -41, -74, -359, -225, -165, -106, -50, -58, 334, 323, 158, 137, 137, 344, 327, 441, 765, 809, 858, 998, 904, 942, 36, -305, -76, 25, 70, 10, 20, -134, -356, -178, -68, -46, -152, 188, 321, 92, -186, -321, -287, -280, -168, -234, -95, 238, 660, 1198, 1328, 1436, 495, -146, -6, 36, 27, 7, -2, -148, -276, 86, 37, 84, 164, 517, 388, 43, -404, -534, -851, -705, -751, -1035, -849, -495, 130, 918, 1542, 1626, 745, -80, 12, 63, 54, 92, 9, -43, -224, 294, 290, 217, 438, 619, 505, 11, -604, -831, -1219, -1021, -1302, -1674, -1543, -995, -199, 856, 1483, 1427, 603, -2, 68, 71, 43, -1, 46, -94, -108, 516, 548, 523, 718, 779, 573, -57, -685, -998, -1194, -1160, -1463, -1726, -1328, -880, -97, 787, 1147, 1052, 405, -107, 61, 29, 4, 47, 31, -109, 33, 541, 554, 741, 914, 878, 637, -154, -828, -1029, -1170, -1279, -1331, -1202, -755, -355, 181, 771, 810, 642, 221, -103, 80, 17, 34, 61, 40, -207, 137, 757, 608, 869, 867, 717, 352, -348, -978, -1142, -1240, -933, -921, -545, -376, 110, 486, 417, 255, 286, 140, -85, 41, 48, 8, 68, 7, -228, 47, 687, 450, 599, 630, 532, 272, -653, -934, -971, -938, -698, -424, -189, -9, 343, 435, 118, -96, 121, 72, -57, 11, 25, 65, 16, 28, -402, -96, 494, 308, 520, 486, 463, 309, -406, -472, -339, -266, -262, -176, -72, 235, 302, 91, -180, -165, -134, -21, 0, 9, 12, 37, 98, 36, -423, -180, 188, 172, 161, 316, 425, 598, 393, 370, 284, 184, 83, 29, 73, 115, 34, -327, -254, -218, -180, -26, 1, 27, 22, 8, 44, -16, -410, -325, 0, -91, -6, 147, 430, 664, 878, 791, 630, 254, 153, 32, 120, -132, -401, -466, -281, -261, -222, -8, 12, 79, 94, 17, 58, -49, -310, -348, -124, -151, -61, 69, 266, 423, 504, 388, 339, 229, 298, 215, 33, -207, -321, -307, -284, -189, -100, -22, 32, 80, 39, 20, 22, 4, -183, -198, -74, -111, -46, 214, 363, 608, 648, 600, 589, 653, 618, 258, 44, -104, -88, -93, -141, -131, -72, 89, 72, 52, 94, 69, 81, 36, -50, -206, -43, -52, 15, 147, 387, 592, 729, 815, 828, 766, 523, 423, 292, 184, 35, -99, -106, -54, -19, 3, 12, 90, 22, 38, 58, 10, -24, 14, -32, -160, -343, -459, -551, -693, -723, -620, -491, -241, -115, 55, 169, 177, 115, 88, 1, -34, 19, 67, 67, 10, 54, 61, 66, 47, 56, 43, -19, -149, -258, -398, -613, -728, -719, -674, -566, -356, -174, -57, 26, 55, 62, 66, 35, 11, 24, 58, 70, 41, 48, 47, 71, 53, 27, 54, -1, -10, -101, -170, -314, -343, -321, -273, -249, -234, -154, -141, -93, -29, 68, 5, 39, -20, 83, 26, 85, 27, 95, 50, 12, 41, 70, 41, 6, 64, -10, 15, 1, -16, 22, -42, -68, -97, -33, -23, -33, -21, 80, 77, 37, 30, 76, 16, 15, 5, 14], 
[46, 38, 88, 42, 41, 65, 30, 6, 81, 89, 91, 90, 76, 17, 57, 3, 80, 52, 86, 27, 86, 58, 38, 81, 52, 93, 42, 57, 74, 88, 33, 18, 73, 72, 91, 7, 70, 88, 33, 12, 28, 51, 21, 71, 55, 74, 78, 64, 49, 79, 84, 48, 11, 37, 38, 68, 12, 7, 13, 50, 70, 24, 41, 106, 61, 62, 88, 72, 183, 203, 190, 111, 52, -86, -198, -241, -159, -65, -52, -21, 0, 4, 97, 40, 23, 96, 84, 21, 13, 9, 9, -12, -85, -92, -130, -169, -84, -32, -40, -267, -521, -758, -860, -825, -543, -313, -130, -62, -44, 29, 61, 64, 64, 80, 38, 33, 30, -28, -71, -304, -463, -544, -570, -388, 127, 742, 849, 668, 342, 206, 411, 458, 392, 291, 107, 40, -59, -22, 29, 12, 75, 66, 3, 80, 26, -95, -217, -441, -636, -791, -653, -354, 241, 899, 942, 489, 399, 490, 773, 804, 772, 486, 135, 10, -52, -77, 12, 43, 62, 93, 36, -4, 17, -150, -344, -543, -828, -927, -771, -535, -139, 91, 39, -324, -263, -91, 304, 421, 308, 261, 0, -86, -175, -140, 16, 58, 34, 54, 75, 37, 74, -119, -318, -605, -682, -830, -737, -631, -343, -211, -49, 113, 72, -15, 137, 142, 56, -158, -367, -387, -342, -251, -66, 76, 59, 68, 119, 127, 64, -4, -236, -410, -539, -518, -575, -564, -576, -128, 573, 1118, 800, 261, 280, 215, -158, -452, -479, -524, -480, -229, 23, 55, 4, 87, 90, 133, 135, -15, -156, -291, -376, -265, -376, -810, -732, 45, 1264, 1884, 862, -53, 11, 110, -351, -442, -493, -427, -425, -278, 4, 42, 67, 68, 86, 63, 126, 38, -96, -140, -118, 42, -392, -1136, -1145, 299, 2125, 2033, 288, -577, -294, -114, -158, -236, -252, -195, -203, -164, -19, 12, 24, 81, 70, 125, 73, 52, -6, 15, 160, 281, -392, -1720, -1665, 729, 2680, 1637, 112, -923, -582, -110, 138, 100, -14, 20, -45, -12, -19, 26, 49, 86, 38, 49, 51, 87, 52, 111, 375, 352, -687, -2288, -1648, 1915, 2485, 1370, 78, -1274, -781, 204, 496, 379, 235, 172, 104, -22, -22, 90, 79, 44, 81, 103, 120, 103, 159, 305, 497, 263, -914, -2588, -1278, 2533, 1949, 1343, 241, -1707, -718, 532, 530, 360, 228, 196, 92, 13, -2, 60, 85, 34, 67, 35, 63, 131, 172, 329, 590, 108, -1166, -2462, -317, 2353, 1494, 1618, -166, -2079, -330, 622, 450, 163, 44, 23, 100, -45, 54, 21, 40, 60, 60, -4, 71, 139, 163, 314, 370, -76, -1203, -1702, 324, 2099, 1622, 1900, -945, -1983, -40, 558, 213, 8, -43, 4, -2, -18, 44, 58, 33, 66, 55, 13, -54, 27, 134, 104, 89, -390, -989, -873, 626, 2053, 2010, 1477, -1491, -1314, 54, 311, 42, -98, -36, 0, -19, -73, 25, 75, 83, 49, 40, -39, -87, -7, -91, -77, -204, -484, -584, -290, 760, 2239, 2158, 272, -1350, -929, -38, 87, -70, -197, -97, -153, -185, -202, 24, 43, 78, 76, 22, -83, -171, -239, -275, -333, -377, -379, -400, -43, 866, 2152, 1643, -404, -1010, -741, -126, -82, -180, -121, -151, -196, -304, -208, 31, 28, 61, 54, -17, -147, -291, -349, -525, -543, -417, -295, -171, 105, 941, 2001, 800, -444, -585, -496, -447, -308, -283, -324, -353, -287, -306, -119, 30, 65, 49, 59, 45, -113, -315, -425, -552, -632, -467, -237, -49, 110, 748, 1238, 318, -197, -161, -463, -470, -428, -469, -372, -378, -312, -186, -61, 85, 7, 48, 11, 59, -105, -253, -304, -450, -405, -161, -79, -219, -164, 152, 354, 92, 170, 158, -81, -306, -377, -470, -423, -365, -276, -83, -4, 84, 6, 93, 96, 20, -83, -142, -175, -184, -78, 245, 351, 138, -187, -218, 51, 323, 603, 560, 290, -198, -382, -278, -300, -297, -144, -8, 24, 38, 47, 32, 9, 71, -31, -108, 30, -13, 193, 571, 676, 589, 275, 178, 552, 1193, 1371, 1229, 730, 279, 60, 62, -4, -17, -19, -4, 46, 90, 93, 58, 54, 44, 53, 3, -10, -89, -257, -391, -534, -831, -976, -886, -483, -70, 186, 382, 440, 342, 295, 179, 94, 67, 12, 34, 80, 29, 30, 18, 75, 61, 60, 8, -72, -196, -342, -550, -819, -823, -784, -677, -524, -310, -103, -2, 154, 178, 145, 74, 60, 53, 73, 60, 4, 33, 7, 54, 49, 28, 24, 30, 21, -67, -167, -119, -248, -186, -40, -41, -26, 104, 67, 113, 199, 145, 69, 19, 24, 46, 26, 29, 54, 88, 85, 67, 55, 75, 90, 83, 72, 15, 88, 14, 35, 32, 88, 137, 131, 104, 122, 97, 42, 31, 95, 53, 93, 90, 29, 62, 97, 54, 83], 
[5, 18, 97, 76, 86, 3, 51, 37, 96, 19, 22, 59, 91, 56, 11, 80, 77, 70, 5, 88, 7, 99, 26, 49, 68, 74, 94, 68, 91, 17, 81, 28, 47, 88, 64, 30, 1, 65, -15, 1, -28, -37, 28, -7, 43, 10, 20, 24, 46, 58, 0, 81, 37, 54, 96, 74, 79, 75, 45, 40, 18, 62, 5, 30, -13, -65, -133, -213, -304, -430, -564, -618, -679, -527, -555, -378, -264, -78, -84, 28, 88, 12, 54, 7, 55, 38, 47, 37, 34, 60, 152, 197, 312, 339, 458, 546, 572, 414, 317, 171, 130, -46, -215, -211, -255, -202, -132, -50, 2, -3, 45, 37, 9, 47, 12, 20, 31, 99, 237, 440, 629, 822, 1051, 1131, 1115, 1068, 975, 809, 601, 497, 142, -176, -215, -217, -225, -192, -108, -22, 85, 24, 89, 79, 95, 7, -20, 78, 279, 503, 770, 941, 1028, 908, 801, 886, 874, 776, 626, 272, 148, 46, -104, -92, -89, -159, -84, 79, 68, 21, 56, 81, 31, 3, 4, 78, 325, 273, 496, 297, 410, 306, 332, 437, 454, 432, 336, 177, 169, 177, 90, 147, 133, -73, -40, 74, 62, 88, 33, 54, 70, 30, -62, -7, 113, 81, -49, -128, -7, 50, 189, 216, 131, 122, 81, 82, 9, 141, 79, 247, 330, -33, -148, 47, 29, 67, 8, 57, 70, 12, -62, 1, 42, -200, -262, -246, -20, 93, 212, 172, 255, 242, 277, 313, 205, 248, 87, 177, 208, -93, -134, 40, 67, 49, 20, 48, 109, 82, 74, 89, -26, -473, -428, -271, -86, -12, -128, -9, 41, 303, 394, 526, 328, 229, 128, 60, 37, -100, -116, -46, 66, 85, 63, 100, 84, 179, 169, -85, -358, -414, -385, -330, -406, -524, -629, -628, -448, -8, 298, 430, 202, 233, 106, 14, -120, -301, -194, 0, 54, 83, 89, 102, 135, 153, 181, -201, -511, -653, -436, -513, -820, -1034, -1225, -1373, -1087, -351, 86, 181, 225, 212, 20, -15, -257, -492, -216, 74, 80, 7, 87, 28, 71, 153, 59, -460, -718, -731, -793, -980, -1349, -1467, -1642, -1791, -1040, -608, -388, -41, 162, 170, 46, -239, -597, -759, -414, 94, 105, 19, 63, 49, 33, 73, -37, -598, -852, -826, -892, -998, -947, -987, -984, -1046, -525, -567, -606, 104, 174, 28, -132, -520, -945, -914, -476, 70, 165, 66, 35, 70, 105, 58, -49, -530, -563, -647, -520, -237, -95, 173, 93, 112, 15, -519, -426, 88, 57, -140, -452, -868, -1224, -933, -425, 196, 240, 99, 58, 18, -11, 78, 81, -140, -197, -183, -84, 154, 393, 541, 687, 305, -15, -273, -26, 364, 137, -151, -614, -977, -1078, -764, -186, 347, 269, 91, 81, 42, 49, 70, 264, 242, 280, 287, 330, 358, 471, 558, 670, 447, 260, 177, 650, 644, 273, -153, -666, -773, -537, -194, 325, 662, 367, 101, 50, 34, 6, 143, 568, 566, 636, 573, 199, 40, 74, 348, 512, 654, 831, 990, 1074, 823, 373, -230, -352, -197, 63, 503, 956, 982, 310, 66, 50, 7, -41, 236, 638, 729, 861, 634, 245, 18, -125, 280, 565, 1012, 1251, 1279, 1044, 634, 322, 28, 198, 488, 823, 1224, 1482, 982, 279, 32, 44, 18, -94, 181, 725, 877, 1095, 847, 634, 364, 161, 386, 665, 821, 1079, 904, 794, 525, 486, 503, 914, 1122, 1451, 1639, 1667, 818, 148, 83, 60, -2, -36, 177, 614, 860, 1124, 1103, 936, 592, 70, 67, 3, -57, 135, 155, 18, 136, 411, 913, 1160, 1504, 1674, 1885, 1389, 623, 153, 80, 38, 62, 19, 112, 657, 791, 1029, 1020, 931, 509, 1, -471, -741, -940, -819, -811, -680, -264, 280, 867, 1228, 1445, 1684, 1500, 985, 367, 55, 97, 22, 64, 5, 173, 334, 527, 630, 725, 528, 440, 233, -174, -347, -701, -672, -703, -377, 8, 277, 614, 835, 1207, 1134, 918, 510, 206, 64, 81, 22, 54, 5, -5, 128, 62, -116, -338, -594, -692, -860, -904, -987, -953, -868, -750, -701, -585, -453, -196, 146, 333, 496, 327, 206, 114, 77, 93, 51, 79, 77, -12, -31, -143, -311, -376, -338, -342, -187, 91, 270, 377, 339, 175, -159, -341, -490, -490, -384, -260, -91, 2, 61, 111, 18, 39, 87, 19, 74, 70, 53, -4, -79, -54, 26, 117, 354, 450, 565, 588, 463, 428, 247, 56, -38, -202, -175, -147, -68, -8, 80, 99, 51, 17, 68, 51, 90, 59, 30, 56, 63, 10, 88, 231, 302, 277, 292, 304, 360, 352, 317, 225, 134, 32, 13, -17, -3, 10, 70, 70, 8, 57, 93, 58, 58, 99, 57, 6, 29, 46, 47, 53, 127, 144, 88, 99, 103, 165, 144, 136, 97, 56, 101, 86, 7, 17, 85, 48, 95, 9], 
[59, 12, 43, 12, 39, 13, 66, 42, 67, 25, 47, 56, 77, 18, 23, 15, 63, 60, 48, 9, 3, 34, 78, 91, 41, 93, 26, 24, 40, 80, 14, 58, 59, 82, 69, 53, 85, 73, 67, 58, 99, 47, 40, 88, 89, 100, 82, 37, 81, 13, 39, 6, 12, 4, 16, 79, 34, 28, 84, 22, 16, 52, 28, 34, 25, 11, 64, 60, 178, 210, 270, 320, 311, 301, 308, 179, 118, 118, 33, 16, 5, 14, 18, 23, 84, 85, 29, 36, 53, 27, 43, -10, -148, -103, -201, -194, -55, -24, 113, 191, 234, 408, 423, 247, 272, 225, 165, 100, 41, 35, 54, 17, 96, 17, 74, 108, 86, 172, 174, 265, 194, 327, 348, 325, 172, 22, -11, -46, -113, -227, -166, -65, -124, -128, -240, -83, -20, 44, 45, 66, 53, 62, 42, 123, 375, 524, 606, 716, 962, 1099, 1300, 1223, 1131, 767, 416, 75, -222, -453, -732, -648, -594, -549, -526, -463, -165, 53, 88, 57, 77, 6, 42, 204, 528, 715, 821, 927, 1148, 1309, 1234, 1149, 1133, 887, 612, 468, 225, 7, -321, -438, -347, -297, -589, -557, -262, -30, 47, 96, 97, 55, 69, 229, 478, 620, 593, 439, 334, 378, 352, 529, 397, 236, 185, 113, 26, -9, -97, -162, 60, -16, -352, -518, -201, 46, 107, 43, 69, 42, -35, 102, 432, 271, 137, -233, -245, -207, -238, -258, -509, -491, -232, -47, 13, 150, 134, 206, 326, 235, -154, -336, -234, 11, 109, 42, 95, -5, -13, 58, 267, 102, -255, -649, -751, -918, -1159, -1319, -1123, -823, 53, 335, 481, 577, 453, 362, 449, 300, -10, -265, -139, 148, 111, 31, 39, 4, -32, -24, -4, -194, -434, -938, -1046, -1437, -1702, -1550, -941, -212, 583, 884, 1008, 852, 535, 273, 216, 22, -30, -184, 23, 147, 117, 33, 38, 84, -56, -72, -160, -383, -539, -833, -1053, -1236, -1220, -646, 150, 542, 1174, 1125, 940, 828, 428, 6, -136, -203, -406, -247, 46, 150, 53, 98, 24, 79, -36, -49, -116, -337, -418, -501, -571, -720, -271, 391, 596, 636, 886, 856, 706, 840, 147, -322, -478, -495, -443, -210, 159, 149, 41, 63, 1, 46, 65, -37, -59, -158, -136, -150, -126, -51, 364, 630, 550, 387, 670, 549, 635, 983, 475, 67, -227, -356, -305, -104, 139, 50, 40, 86, 34, 77, 59, -11, -76, -26, -91, -2, -72, -56, 257, 355, 278, 106, 396, 367, 654, 1195, 979, 635, 188, 10, 19, 27, 183, 54, 50, 43, 97, 52, 125, 174, 79, 60, -28, -54, -76, -133, -163, 35, -154, -41, 131, 75, 462, 1156, 1006, 781, 518, 369, 224, 191, 166, 12, 1, 0, 10, 68, 93, 257, 119, 6, -66, -150, -229, -493, -532, -483, -403, -534, -441, -523, 132, 957, 992, 865, 815, 548, 525, 220, -25, -21, 38, 0, 60, 34, 188, 444, 275, -80, -242, -379, -439, -703, -974, -934, -910, -976, -856, -588, -185, 421, 654, 849, 732, 590, 397, -42, -205, -165, -8, -1, 85, 92, 227, 771, 578, 68, -243, -508, -608, -856, -1004, -1022, -1004, -1059, -939, -470, -117, 408, 518, 809, 629, 417, 242, -207, -458, -131, -18, 7, 24, 89, 310, 975, 989, 301, -147, -461, -625, -673, -826, -852, -991, -881, -731, -281, 60, 502, 579, 577, 323, 58, -89, -511, -565, -181, -23, 8, 34, 51, 348, 1072, 1106, 605, 150, -87, -249, -432, -487, -656, -573, -517, -222, 28, 347, 528, 652, 268, 56, -213, -412, -628, -466, -143, 56, 66, 53, 30, 274, 957, 1258, 725, 447, 185, 75, 155, -28, -33, -111, 25, 198, 244, 433, 561, 231, -9, -10, -312, -624, -658, -410, -101, 55, 58, 14, 87, 249, 648, 1057, 906, 788, 555, 556, 532, 360, 179, 166, 213, 184, 262, 225, 181, 47, -179, -310, -475, -631, -417, -178, -5, 89, 15, 3, 71, 142, 439, 754, 886, 998, 861, 891, 921, 914, 793, 650, 425, 200, 73, -56, -160, -249, -188, -239, -301, -297, -153, -53, 5, 94, 4, 22, 60, 47, 239, 403, 643, 786, 930, 994, 988, 894, 805, 594, 434, 5, -60, -202, -256, -152, -241, -217, -53, 25, 34, 51, -1, 50, 55, 74, 29, 45, 60, 90, 127, 226, 181, 229, 269, 254, 173, 57, -14, -56, -252, -250, -201, -161, -71, -88, 22, 3, 34, 81, 48, 54, 29, 55, 86, 37, 32, 18, 92, 104, 22, 9, -63, -58, -99, -197, -316, -265, -251, -165, -105, -99, 21, -3, 110, 67, 34, 77, 23, 55, 54, 31, 8, 55, 19, 40, 93, 14, 52, 9, 31, 45, 58, 7, 25, -45, -21, 28, 2, 60, 53, 58, 71, 2, 79, 25, 85, 13, 79], 
[12, 46, 75, 50, 0, 51, 60, 1, 28, 43, 18, 93, 89, 75, 41, 48, 7, 8, 62, 94, 3, 70, 43, 50, 40, 7, 26, 36, 24, 37, 87, 17, 47, 6, -5, 76, -1, -7, -44, -24, -1, -65, -5, -15, -34, -9, -32, 54, 15, -4, 39, 65, 96, 22, 64, 17, 90, 81, 84, 23, -4, 47, 10, -56, -95, -188, -289, -531, -617, -649, -651, -568, -508, -315, -311, -195, -111, -49, -39, 56, 33, 82, 1, 86, 84, 0, 9, 30, -5, 45, 25, -8, -98, -295, -453, -676, -940, -1005, -938, -876, -724, -712, -524, -380, -335, -200, -124, 19, 25, 66, 86, 73, 70, 40, 80, 76, 89, 82, 56, 68, -66, -201, -426, -667, -642, -585, -428, -187, -213, -262, -483, -460, -199, -74, 45, 145, 135, 20, 60, 63, 42, 1, 59, 58, 74, 87, 222, 221, 195, 110, -1, -284, -330, -214, -59, 222, 494, 456, 491, 311, 422, 575, 712, 673, 429, 56, 17, 53, 1, 8, 29, 50, 87, 185, 276, 323, 378, 513, 406, 199, -352, -810, -1253, -1250, -778, -107, 406, 648, 924, 976, 988, 840, 494, 45, -36, 89, 54, 86, 46, 97, 120, 76, 143, 315, 386, 458, 157, -288, -1057, -1508, -2114, -2052, -1476, -711, -63, 238, 583, 643, 557, 393, 192, -112, -55, 49, 96, 53, -19, 89, 50, 0, 53, 119, 104, 16, -313, -574, -961, -1340, -1833, -1744, -1157, -247, 130, 301, 354, 466, 215, 94, -143, -170, -15, 55, 27, 39, 52, 18, -75, -101, -123, -156, -287, -309, -361, -209, -489, -633, -1038, -1111, -323, 477, 677, 435, 164, 148, 1, -56, -256, -206, -14, 80, 67, 61, 22, -59, -79, -174, -158, -320, -364, -304, 268, 446, 204, -20, -445, -474, 507, 992, 796, 229, -259, -202, -140, -183, -267, -123, -18, 61, 79, -6, 24, -48, -128, -128, -217, -330, -160, 280, 641, 656, 555, 310, -487, -144, 1005, 1112, 651, -231, -508, -476, -255, -117, -62, -62, 38, 18, 34, 34, 7, -4, 5, 90, 65, 129, 269, 698, 901, 899, 582, -167, -806, 200, 1101, 958, 303, -404, -607, -472, -272, 10, 31, -18, 12, 79, 80, 48, 14, 0, 171, 535, 727, 608, 769, 761, 925, 762, 195, -444, -844, 207, 729, 783, 444, 26, -142, 160, 133, 217, 155, -18, 64, 21, 34, 60, 44, 115, 266, 1116, 1298, 1121, 927, 547, 665, 444, 195, -266, -356, 294, 424, 765, 749, 510, 744, 615, 487, 393, 221, -93, 28, 95, 54, 42, 20, 130, 344, 1280, 1514, 1416, 911, 551, 548, 539, 825, 821, 818, 748, 661, 1045, 1023, 1217, 940, 706, 487, 431, 140, -88, 6, 27, 38, 93, 87, 10, 266, 1049, 1438, 1326, 943, 683, 543, 855, 1062, 1424, 1406, 1145, 974, 805, 864, 864, 617, 238, 150, 142, 34, 7, 99, 59, 79, 27, 96, 14, 27, 638, 833, 854, 686, 318, 127, 373, 901, 1209, 1382, 1219, 775, 135, 120, -44, -294, -197, -77, 37, 76, 23, 81, 19, 48, 38, 51, -87, -154, 129, 181, 59, -144, -543, -947, -687, -136, 379, 716, 675, 75, -496, -633, -718, -701, -487, -250, -80, 60, 105, 51, 107, 44, 29, 23, -33, -322, -405, -433, -538, -855, -1150, -1548, -1186, -728, -5, 458, 293, -214, -449, -593, -603, -451, -396, -236, -85, 16, 120, 129, 26, 82, 7, 16, -71, -317, -576, -720, -773, -989, -1223, -1339, -1032, -488, 160, 378, 147, -105, -162, -358, -302, -352, -224, -170, -70, 86, 86, 26, 91, 5, 56, 31, 3, -364, -527, -696, -780, -686, -677, -775, -662, -359, -13, -91, 9, 199, 73, 46, 15, -33, -133, -73, -45, 69, 50, 27, 47, 67, 83, 95, 37, -226, -448, -599, -626, -398, -248, 23, 161, 274, 394, 412, 567, 704, 717, 335, 185, 126, -29, -41, -88, 26, 60, 64, 32, 29, 36, 9, 20, -78, -277, -481, -590, -483, -319, -162, -83, -94, 107, 183, 429, 633, 541, 350, 326, 202, 124, 76, 14, 60, 91, 11, 6, 70, 14, 38, 60, 12, -115, -226, -283, -393, -518, -620, -818, -1030, -860, -697, -367, -163, -95, 66, 201, 172, 143, 43, 17, -3, 45, 90, 42, 95, 4, 26, 47, 17, 10, 31, -33, -217, -449, -913, -1303, -1650, -1549, -1465, -1279, -1300, -1282, -989, -629, -393, -180, -57, 46, 48, 45, 12, 72, 1, 1, 18, 9, 56, 20, 4, -90, -157, -429, -618, -851, -952, -1002, -980, -946, -824, -737, -514, -263, -229, -89, 31, 7, 54, 32, 85, 76, 34, 76, 68, 54, 55, 38, 24, 84, 14, -8, -8, -12, -13, -82, -93, -47, -76, -33, 43, -16, 70, 69, 84, 68, 60, 58, 30, 14], 
[56, 39, 23, 95, 86, 30, 64, 34, 76, 99, 81, 60, 101, 79, 20, 68, 84, 75, 48, 24, 77, 95, 59, 14, 6, 51, 53, 94, 8, 61, 93, 4, 21, 82, 25, 78, 52, 68, 120, 66, 74, 41, 46, 92, 24, 23, 84, 68, 48, 99, 90, 71, 33, 99, 18, 27, 89, 26, 89, 89, 16, 14, 34, 68, 106, 184, 135, 208, 163, 136, 63, -28, -74, -84, -166, -93, -102, -111, -6, -30, 22, 52, 36, 29, 5, 12, 1, 45, 38, 16, 32, 93, 182, 194, 273, 233, 249, 124, -21, -131, -234, -412, -480, -459, -389, -216, -141, -43, 52, 54, 42, 74, 20, 36, 62, 34, -29, -30, 5, -42, 4, 57, 110, 92, -75, -263, -332, -373, -254, -305, -314, -247, -6, 241, 485, 611, 389, 224, 60, 83, 18, 29, 75, 58, -94, -95, -140, -185, -202, -219, -142, -160, -509, -643, -894, -880, -719, -466, -101, 86, 446, 842, 1288, 1467, 1201, 572, 192, 53, 29, 49, 59, 23, -141, -168, -215, -307, -174, -105, 82, 110, -173, -432, -615, -643, -451, -2, 254, 414, 696, 984, 1504, 2054, 2172, 1252, 366, 102, 15, 25, 66, 6, -194, -128, -149, -26, 49, 221, 216, 65, -141, -358, -375, -316, -70, 138, 351, 571, 585, 809, 1389, 2197, 2876, 1912, 545, 70, 6, 38, 82, -6, -104, 2, 46, 193, 280, 359, 222, 366, 129, 84, -16, 3, 34, 113, 155, 40, -116, 122, 651, 1616, 2692, 2147, 535, 80, 10, 69, 19, -6, -97, 20, 266, 494, 430, 421, 560, 585, 385, 243, -116, -397, -507, -606, -648, -652, -740, -656, -280, 589, 1828, 1778, 517, 129, 64, 44, 35, 49, 81, 246, 459, 640, 554, 630, 818, 734, 655, 393, 10, -489, -889, -1072, -1337, -1522, -1556, -1444, -1287, -593, 594, 957, 301, 112, 61, 70, 0, 98, 210, 372, 508, 553, 669, 546, 675, 845, 866, 589, 239, -314, -837, -1164, -1537, -1583, -1695, -1951, -1830, -1247, -284, 471, 153, 19, 40, 40, 1, 112, 179, 337, 328, 426, 430, 676, 943, 779, 859, 897, 663, -127, -632, -894, -947, -857, -1165, -1510, -1662, -1390, -668, 52, 39, 92, 85, 58, 33, 126, 214, 173, 72, 248, 487, 908, 811, 643, 692, 881, 526, 21, -207, -403, -324, -310, -531, -1015, -1179, -1087, -538, 70, 84, 19, 75, 3, 16, 62, 145, -147, -406, -96, 273, 757, 629, 411, 378, 446, 202, -142, -189, -103, -30, 174, -191, -662, -834, -830, -332, 74, 5, 72, 68, 69, 53, 109, 9, -508, -638, -392, -176, 172, 73, -26, 74, 70, 6, -89, -18, -151, 70, 152, -158, -488, -535, -437, -133, 0, 8, 66, 94, 35, 12, 57, -21, -510, -490, -533, -407, -375, -549, -570, -366, -175, -27, -36, 2, -34, 222, 160, -252, -324, -321, -164, 38, 29, 0, 31, 50, 37, 14, 73, -32, -188, 115, -121, -527, -532, -751, -769, -520, -117, 155, 146, 187, 305, 487, 184, -241, -212, -71, 106, 122, -12, 68, 67, 14, 52, 40, 101, 80, 84, 774, 441, -283, -524, -774, -680, -469, -122, 289, 271, 246, 310, 342, 91, -112, 56, 107, 167, 112, 18, 23, 10, 64, 42, -17, 36, -46, 254, 1146, 1009, 555, 86, -283, -320, -111, -20, 101, 85, 18, 232, 231, 93, 204, 332, 281, 265, 149, -63, 59, 3, 86, 38, -9, 37, -74, 126, 965, 1342, 1160, 925, 458, 340, 157, 145, 9, -2, 13, -40, 239, 243, 401, 459, 300, 256, 139, -22, 32, 84, 13, 84, -7, -3, -208, -81, 625, 1107, 1137, 1195, 1011, 707, 372, 43, 9, -80, -52, 117, 474, 441, 371, 476, 393, 271, 29, 33, -6, 5, 28, 73, 44, 45, -188, -363, -158, 139, 666, 948, 941, 636, 483, 202, -14, -36, 345, 463, 519, 529, 448, 519, 328, 107, 28, 41, 66, 22, 17, 44, 77, 44, -14, -287, -419, -380, -245, 27, 255, 376, 333, 324, 306, 324, 322, 269, 423, 463, 366, 401, 228, 110, 89, 82, 9, 30, 49, 20, 1, 56, 1, -47, -60, -53, -14, -31, 17, 53, 122, 119, 94, 38, -17, -93, 29, 179, 269, 237, 200, 88, 73, 0, 85, 0, 21, 56, 52, 73, 1, -7, 51, 86, 92, 110, 159, 232, 192, 88, 52, -33, -67, -162, 21, 8, 49, 58, 89, 105, 39, 72, 75, 31, 35, 97, 65, 6, 96, 58, -17, 14, -33, -69, -54, 43, 0, 31, -38, -38, -14, -4, -64, 6, 91, 16, 89, 56, 74, 78, 76, 24, 58, 15, 86, 98, 9, 23, 59, 38, 40, 64, 90, 74, 60, 91, 28, 11, 13, 48, 81, 72, 13, 88, 93, 72, 19, 72, 61, 52], 
[7, 96, 70, 7, 31, 49, 74, 87, 50, 70, 52, 51, 12, 38, 1, 92, 66, 82, 86, 85, 86, 58, 93, 69, 51, 56, 82, 69, 97, 47, 24, 1, 51, 21, 62, 41, 114, 105, 131, 146, 238, 188, 181, 196, 130, 143, 127, 143, 150, 88, 110, 15, 65, 25, 22, 5, 64, 81, 45, 95, 99, 67, 72, 175, 269, 390, 643, 826, 1028, 1314, 1449, 1649, 1637, 1635, 1447, 1214, 836, 565, 330, 172, 42, 80, 78, 38, 4, 54, 81, 88, 97, 76, 51, 64, 153, 215, 351, 475, 622, 983, 1328, 1867, 2321, 2735, 2651, 2343, 1712, 1054, 686, 339, 217, 51, 38, 67, 30, 70, 16, 88, 78, 46, -66, -88, -138, -248, -294, -427, -448, -419, -309, -24, 391, 597, 917, 955, 715, 402, 303, 174, 134, 79, 32, 45, 86, 7, 13, 64, -10, -10, -96, -202, -306, -222, -324, -328, -463, -564, -591, -249, -12, 124, 6, 83, -220, -290, -282, -237, -60, 16, 88, 101, 31, 63, 88, 56, 0, -28, -162, -153, -222, -235, -317, -422, -564, -640, -450, -438, -510, -653, -705, -729, -770, -772, -676, -486, -137, -30, 80, 53, 6, 70, 60, 82, -32, -10, -45, -32, 52, 4, -106, -271, -361, -178, -20, -386, -576, -857, -934, -885, -826, -851, -705, -489, -197, -58, 33, 7, 89, 60, 47, 96, 0, -52, -5, 192, 314, 237, 6, -202, -21, 161, -65, -489, -853, -1102, -1194, -1090, -800, -770, -742, -501, -261, -44, 57, 69, 21, 71, 99, 91, 19, -101, 8, 335, 281, 25, -173, -12, 324, 247, -196, -714, -1137, -1297, -1350, -1242, -1000, -879, -840, -631, -262, -71, -48, 39, 18, 101, 111, 48, -51, -62, 195, 339, 177, -60, -163, 212, 499, 301, -41, -663, -1020, -1187, -1108, -1039, -812, -703, -641, -454, -248, -126, 28, 61, 84, 84, 20, 49, -51, 29, 312, 358, -6, -294, 75, 543, 602, 356, 35, -655, -941, -690, -642, -513, -401, -318, -139, 42, 100, -10, 18, 88, 83, 52, 34, -5, -78, 50, 310, 180, -68, -16, 455, 831, 641, 411, 59, -357, -243, 29, -11, -36, 107, 234, 532, 652, 370, 27, 42, 26, 97, 84, 79, -3, -43, 81, 211, 183, 42, 340, 730, 913, 553, 254, 145, 212, 549, 646, 345, 288, 390, 674, 1110, 1024, 625, 189, -16, 0, 53, 61, 52, 44, -154, -145, -30, 18, 182, 463, 879, 586, 89, 3, 411, 894, 1139, 791, 222, 107, 369, 891, 1217, 1088, 657, 219, -26, -2, 33, 81, 71, -6, -175, -314, -238, -184, 172, 482, 626, 147, -484, -88, 640, 933, 680, 28, -294, -55, 381, 875, 1136, 897, 541, 155, -12, 3, 12, 38, 71, -14, -313, -534, -517, -403, 80, 380, 490, 54, -267, 68, 590, 320, -32, -345, -318, 146, 632, 819, 915, 627, 244, -113, -89, 78, 32, 69, 7, -100, -445, -661, -583, -348, 158, 675, 863, 675, 166, 47, 59, -447, -575, -350, 161, 693, 876, 806, 583, 205, -46, -254, -98, 59, 57, 95, 24, -92, -423, -660, -645, -265, 304, 1048, 1616, 1418, 810, 166, -226, -460, -31, 454, 816, 965, 789, 325, 141, -155, -298, -254, -70, 6, 7, 87, 52, -85, -364, -540, -586, -365, 75, 992, 1647, 1530, 1114, 470, 308, 311, 620, 939, 1103, 868, 200, -44, -290, -405, -552, -222, 14, 57, 76, 44, 28, 17, -255, -494, -574, -561, -241, 431, 1150, 1338, 1218, 1006, 1016, 1210, 1227, 1267, 938, 447, 33, -430, -490, -558, -451, -223, -29, 90, 96, 82, 51, 37, -174, -287, -432, -584, -582, -345, 566, 1170, 1496, 1548, 1625, 1608, 1372, 943, 432, -70, -321, -468, -560, -458, -285, -43, -6, 11, 13, 24, 75, 87, -19, -40, -77, -182, -654, -1060, -1151, -722, -484, -280, -258, -352, -461, -428, -415, -365, -370, -335, -307, -258, -98, -14, 36, 96, 9, 8, 30, 125, 201, 310, 592, 800, 716, 322, -289, -784, -1139, -1230, -1278, -1162, -914, -536, -265, -108, -40, -138, -62, -34, -29, 17, 45, 18, 60, 24, 84, 82, 110, 205, 376, 555, 814, 1005, 1068, 983, 784, 647, 441, 322, 133, -27, -19, -178, -108, -92, -39, -19, 2, 72, 46, 52, 26, 49, 91, 63, 18, 106, 80, 85, 162, 188, 349, 415, 353, 319, 231, 87, -20, -125, -145, -63, -84, 3, 53, 76, 54, 64, 94, 6, 55, 23, 9, 19, 44, 8, 107, 75, 79, 165, 190, 328, 372, 339, 264, 212, 153, 56, -31, 1, -23, 51, 67, 21, 64, 29, 80, 90, 3, 89, 82, 78, 50, 96, 86, 19, 34, 87, 53, 29, 122, 35, 51, 55, 72, 55, 47, 33, 1, 18, 35, 10, 35, 13, 54, 97], 
[65, 96, 90, 65, 73, 15, 73, 18, 95, 8, 38, 17, 99, 48, 93, 59, 12, 57, 47, 31, 88, 66, 97, 5, 4, 86, 24, 42, 68, 81, 76, 74, 42, 86, 36, 16, 4, 51, -4, 47, 44, 92, 20, 76, 68, 75, 52, 28, 88, 6, 34, 69, 5, 86, 7, 50, 94, 74, 68, 6, 51, 75, 53, 59, 7, 46, -2, -5, 42, 148, 204, 288, 298, 322, 238, 158, 190, 104, 98, 62, 70, 77, 12, 6, 45, 6, 51, 71, 22, 48, 48, 107, 67, 69, 52, 174, 238, 402, 518, 633, 779, 771, 612, 444, 372, 240, 173, 76, 61, 66, 52, 55, 90, 45, 38, 40, 20, 89, 61, 127, 109, 140, 114, 202, 260, 425, 562, 656, 785, 850, 790, 706, 531, 429, 355, 173, 143, 83, 37, 7, 58, 11, 29, 57, 40, -5, -45, -131, -178, -337, -435, -378, -303, -300, -302, -183, 46, 108, 236, 251, 198, 243, 220, 202, 141, 144, 10, 86, 59, 17, 57, 43, 33, -7, -64, -144, -145, -302, -334, -558, -736, -934, -1224, -1370, -1275, -1040, -933, -623, -438, -291, -121, -115, -19, 20, 1, 53, 20, 94, 165, 225, 224, 289, 469, 653, 804, 816, 740, 482, 46, -280, -344, -468, -397, -144, 156, 332, 495, 369, 250, 56, -157, -165, 8, -8, 35, 143, 246, 491, 674, 844, 983, 1202, 1264, 1212, 1088, 1013, 913, 848, 702, 621, 510, 423, 447, 259, 519, 265, 99, -45, -192, -216, 28, 17, 106, 178, 357, 658, 855, 974, 1038, 1160, 1019, 1006, 1002, 1106, 1290, 1388, 1457, 1475, 1372, 955, 544, 402, 299, 361, 256, 1, -113, -134, 4, 5, 15, 143, 445, 703, 1043, 904, 775, 667, 523, 424, 363, 539, 856, 1134, 1393, 1684, 1439, 1156, 689, 459, 378, 389, 237, -23, -105, 19, 42, 41, 18, 136, 366, 663, 856, 550, 275, 40, -74, -320, -331, -209, 103, 242, 236, 466, 638, 836, 637, 346, 213, 302, 123, -93, -121, 14, 83, 80, 22, 64, 249, 528, 473, 101, -132, -397, -710, -813, -632, -492, -614, -832, -952, -270, 190, 808, 612, 178, 107, 158, 0, -268, -106, 24, 10, 40, 41, 124, 186, 373, 169, -323, -544, -687, -873, -819, -676, -846, -1113, -1794, -1355, -389, 407, 765, 571, 168, 77, 120, -70, -220, -24, 44, 67, 45, 11, 48, 137, 235, 22, -471, -597, -761, -817, -850, -962, -1112, -1479, -2057, -1146, 236, 620, 912, 637, 433, 359, 194, 48, -34, -52, 149, 12, 85, 72, 54, 109, 110, -30, -391, -483, -557, -665, -690, -905, -1140, -1615, -1689, -267, 545, 886, 977, 678, 432, 342, 307, 279, -1, 58, 74, 105, 72, 85, 23, 76, 146, -93, -322, -216, -335, -403, -587, -719, -1153, -1399, -908, 174, 405, 664, 614, 439, 383, 235, 208, 149, -17, 2, 108, 57, 9, 49, 70, 43, 55, -104, -243, -223, -236, -237, -407, -675, -948, -639, -116, 205, 201, 382, 162, 23, 139, 113, 49, 23, -56, -8, 78, 108, 7, 5, 36, 3, 49, -122, -258, -320, -132, -211, -271, -504, -462, 84, 276, 348, 280, 72, -119, -100, 27, -14, -25, -147, -154, 31, 125, 110, 94, 89, 16, -21, 56, -165, -280, -323, -342, -299, -283, -382, -34, 327, 323, 280, 102, -396, -454, -285, -154, -144, -139, -223, -146, 24, 157, 43, 11, 93, 64, 2, -80, -240, -393, -382, -448, -381, -294, -93, 251, 228, 355, 254, -95, -447, -360, -290, -176, -202, -220, -203, -109, 35, 81, 58, 95, 5, 21, -13, -57, -158, -369, -468, -495, -469, -321, -3, 248, 408, 416, 112, -181, -291, -129, -223, -303, -281, -316, -202, -62, 41, 118, 65, 96, 63, 47, 26, -60, -200, -294, -361, -315, -411, -216, -61, 149, 129, 75, -17, -116, -5, -133, -294, -507, -373, -297, -204, -130, 28, 44, 5, 9, 48, 60, 42, -11, -87, -133, -67, -24, 0, 118, 125, 106, -20, -42, 6, 18, 11, -240, -362, -497, -421, -305, -116, -96, -18, 36, 47, 22, 26, 56, 2, 1, 58, 240, 435, 555, 700, 716, 868, 714, 431, 345, 344, 452, 317, -21, -202, -366, -283, -207, -77, -32, 34, 5, 15, 38, 99, 73, 60, 105, 153, 309, 659, 1050, 1476, 1727, 1877, 1820, 1612, 1609, 1552, 1263, 947, 392, 52, -121, -145, -75, -35, -34, 31, 96, 47, 99, 78, 57, 60, 92, 91, 164, 402, 775, 1128, 1391, 1611, 1626, 1747, 1758, 1732, 1473, 1215, 729, 345, 186, 3, -31, 106, 41, 16, 37, 94, 87, 3, 79, 46, 51, 76, 52, 83, 80, 107, 141, 258, 277, 346, 478, 482, 421, 417, 332, 280, 131, 51, 29, 66, 14, 56, 40, 86, 57], 
[97, 30, 14, 86, 9, 98, 76, 13, 53, 96, 82, 48, 31, 54, 89, 28, 68, 26, 47, 63, 88, 63, 61, 19, 61, 49, 49, 64, 75, 63, 16, 38, 50, 93, 84, 36, 81, 80, 26, 27, 19, 88, 90, 34, 27, 89, 22, 37, 37, 87, 57, 47, 15, 41, 15, 31, 76, 4, 80, 74, 27, 65, 58, 43, 110, 57, 105, 87, 126, 83, -3, -23, -12, 27, 55, 124, 96, 142, 54, 102, 92, 78, 95, 45, 6, 82, 52, 45, 90, 21, 8, 111, 149, 170, 162, 97, 46, -102, -344, -514, -607, -531, -402, -216, -72, 105, 90, 82, 35, 67, 24, 81, 11, 37, 75, 36, 96, 47, 9, 45, 15, -64, -182, -174, -284, -522, -572, -655, -721, -762, -806, -798, -495, -318, -196, -84, -67, 51, 17, 5, 94, 66, 93, 27, -37, -96, -171, -337, -390, -481, -551, -237, 46, 398, 875, 1406, 1330, 1136, 774, 278, 82, -133, -117, -246, -176, -20, 82, 6, 17, 80, 88, 32, -57, -63, -277, -272, -292, -187, -181, -68, 195, 302, 577, 689, 637, 314, 300, 173, 99, 41, 83, 31, -35, -20, 60, 0, 1, 61, 60, -24, 10, -27, -94, 6, 2, 73, 159, 113, 5, 5, -74, -83, -241, -290, -342, -226, -136, 26, 324, 512, 287, -83, 20, 57, 61, 11, 17, -12, -19, 31, 75, 190, 359, 408, 312, 263, 134, -139, -476, -864, -865, -762, -550, -189, 167, 356, 901, 947, 577, 119, 19, 4, 6, 69, 0, 18, 18, 142, 182, 414, 716, 759, 644, 560, 377, -196, -892, -1126, -1068, -673, -322, 120, 693, 764, 1074, 1171, 829, 200, 125, 89, 32, 7, -7, -12, 35, 186, 227, 469, 627, 760, 842, 850, 735, 30, -972, -1082, -746, -247, 319, 774, 972, 1091, 1255, 1194, 764, 274, 132, 90, 47, 4, 67, 25, 108, 102, 125, 358, 442, 474, 777, 1335, 1250, 536, -544, -586, -316, 99, 563, 904, 929, 925, 1043, 828, 485, 274, 58, 41, 51, 46, 64, -14, 39, -11, -8, 58, -55, -85, 323, 1525, 1914, 824, 15, -46, 89, 427, 805, 751, 627, 521, 479, 278, 192, 177, 113, 96, 7, 5, 7, 83, -42, -273, -317, -499, -814, -1110, -424, 1315, 1716, 821, 474, -9, 30, 370, 175, -135, -163, -40, -130, -98, -40, 123, 48, 47, 87, 17, 15, 88, -102, -384, -419, -768, -1368, -1654, -697, 792, 858, 654, 331, -130, 33, -5, -906, -1039, -677, -372, -304, -225, -123, 89, 24, 53, 77, 64, 72, 12, -31, -305, -460, -881, -1363, -1539, -633, 540, 684, 593, 7, -169, 224, -628, -1520, -1262, -684, -511, -399, -332, -191, 45, 0, 97, 31, 22, 80, 3, 0, -233, -500, -599, -961, -657, 239, 988, 1028, 603, -154, -52, 315, -605, -1151, -1068, -613, -304, -287, -302, -86, 61, -20, 50, 61, 78, 3, -13, 6, -302, -396, -491, -60, 537, 1285, 1975, 1368, 238, -458, 86, 269, -295, -621, -741, -476, -370, -322, -250, -156, 12, 74, 34, 0, 22, 42, -100, -136, -227, -359, 105, 644, 1200, 2063, 1938, 1026, -321, -845, -37, 109, -63, -366, -552, -450, -316, -444, -304, -185, -91, 19, 29, 2, 84, -21, -193, -190, -118, -131, 347, 797, 1305, 1680, 1220, 69, -1091, -1045, -441, -100, -74, -367, -523, -507, -500, -468, -280, -205, -36, -23, 29, 71, 46, 32, -247, -287, -145, -14, 200, 520, 776, 823, 165, -714, -1340, -1168, -695, -369, -318, -477, -554, -630, -566, -340, -195, -190, -138, 24, 17, 31, 7, 28, -218, -308, -85, -47, 67, 105, 184, 86, -109, -293, -406, -451, -231, -240, -360, -422, -362, -417, -394, -294, -171, -159, -63, 52, 8, 26, 31, -22, -184, -391, -192, -129, -251, -405, -443, 55, 422, 488, 770, 719, 433, -8, -159, -41, 18, 15, -139, -112, -50, -133, -24, 74, 40, 55, 16, 16, -67, -316, -255, -152, -247, -485, -547, -128, 655, 1322, 1641, 1438, 1013, 634, 493, 550, 351, 241, 131, -4, -13, -25, 42, 24, 93, 20, 43, 36, -43, -127, -326, -258, -241, -193, -170, -16, 360, 743, 782, 757, 484, 466, 437, 430, 514, 331, 316, 187, 72, 28, 93, 61, 31, 10, 21, 60, 62, 6, -84, -275, -383, -644, -765, -866, -956, -817, -776, -639, -460, -208, -111, 63, 159, 104, 124, 125, 43, 96, 17, 42, 68, 65, 59, 22, 91, 24, -7, -78, -134, -206, -246, -164, -259, -260, -211, -221, -75, -26, 8, 8, 123, 110, 42, 40, 99, 4, 99, 50, 3, 19, 97, 82, 24, 34, 47, 34, 67, 76, 7, 0, 13, 34, 5, 50, -9, 11, 21, 25, 90, 91, 71, 8, 48, 23, 86, 37, 67], 
[83, 71, 34, 30, 62, 22, 29, 97, 93, 76, 93, 65, 45, 13, 65, 10, 0, 37, 19, 34, 49, 13, 76, 34, 66, 87, 38, 61, 50, 9, 96, 11, 94, 95, 30, 48, 67, 86, 27, -10, 6, -4, -13, -5, -15, 17, 70, -10, 75, 0, 33, 13, 81, 65, 65, 69, 79, 10, 85, 2, 75, 44, 94, 18, 72, 57, 65, -50, -102, -148, -184, -249, -271, -281, -257, -138, -29, -59, 21, 15, 45, 47, 10, 84, 0, 94, 77, 77, 33, 20, 44, 9, 118, 79, 171, 129, 110, 77, -27, -117, -152, -195, -85, -85, 18, 0, 11, 99, 91, 15, 87, 24, 74, 55, 66, 79, 62, -9, 45, 189, 293, 489, 694, 755, 671, 441, 189, -17, -49, 91, 281, 237, 145, 71, 49, 6, 49, 65, 72, 15, 50, 57, 58, 74, 45, 28, 105, 160, 289, 398, 435, 165, -282, -928, -1341, -1737, -1791, -1610, -1231, -824, -451, -426, -470, -355, -298, -7, 62, 7, 81, 53, 54, 26, -17, -92, -99, -119, -126, -219, -292, -189, 321, 1021, 1598, 2009, 1663, 1094, 302, -7, -422, -507, -834, -795, -638, -190, -39, 19, 1, 54, -17, -104, -267, -450, -571, -708, -781, -916, -705, -6, 1114, 1827, 2468, 2660, 2357, 1563, 634, -236, -615, -726, -899, -859, -751, -389, -84, 12, 65, 41, -71, -182, -505, -696, -751, -944, -1073, -804, -304, 165, 779, 843, 1063, 1357, 1241, 926, 361, -133, -479, -481, -584, -719, -660, -340, -7, 9, 7, 27, -142, -299, -498, -627, -748, -721, -506, -182, 237, 374, 281, 68, 95, 51, 117, 129, 111, 49, 21, 11, -169, -333, -415, -250, -67, 87, 6, 24, -156, -245, -405, -270, -281, -2, 256, 585, 707, 476, -53, -620, -880, -495, -460, 17, 338, 350, 555, 296, 188, 33, -107, -190, -21, 85, 50, 59, -110, -261, -204, 151, 349, 671, 831, 994, 689, 363, -465, -969, -289, 158, 117, 393, 622, 730, 759, 551, 588, 302, 37, -101, -15, 68, 55, -13, -96, -93, 142, 526, 796, 1008, 1128, 1016, 546, -274, -714, -241, 860, 757, 418, 529, 756, 704, 744, 544, 454, 293, 80, 2, -8, 54, 17, 12, -8, -2, 299, 647, 719, 885, 993, 790, 157, -400, -116, 638, 1430, 895, 368, 465, 761, 560, 415, 97, 177, -12, -56, -9, 68, 68, 32, 77, 37, 29, 290, 516, 449, 606, 659, 842, 451, 320, 518, 923, 978, 115, 58, 708, 778, 149, -295, -371, -251, -285, -160, -92, 54, 82, 8, 33, 50, 19, 201, 167, 34, 214, 552, 789, 790, 831, 738, 404, -172, -324, 89, 897, 406, -603, -847, -805, -547, -419, -279, -34, 29, 47, 9, 85, 39, 40, 94, -82, -272, -144, 145, 502, 719, 854, 497, -256, -445, -237, 253, 526, -380, -1077, -964, -710, -565, -394, -269, -44, -1, 13, 96, 61, 59, 37, 5, 15, -239, -185, -142, 127, 452, 236, -117, -585, -329, -90, 284, 226, -670, -964, -594, -425, -398, -262, -228, -18, 33, 79, 70, 5, 9, 36, 38, 93, -18, -298, -301, -261, -269, -285, -605, -444, -200, -64, 36, -190, -606, -624, -184, -194, -191, -154, -193, 9, 74, 1, 30, 84, 3, 20, 32, 143, -38, -192, -432, -774, -939, -1038, -951, -537, -365, -43, 57, -337, -471, -275, 94, -49, -88, -173, -51, 4, 56, 63, 24, 88, 1, 16, 102, 147, -6, -216, -465, -877, -1000, -1015, -780, -495, -232, -106, -201, -367, -226, 32, 97, 120, -23, -56, -47, 39, 82, 27, 1, 85, 65, -3, 102, 151, 59, -35, -287, -519, -744, -729, -583, -609, -265, -411, -401, -389, -149, -7, -11, 59, -3, 34, 57, 5, -5, 14, 59, 27, 33, 65, 63, 58, 1, -24, -98, -216, -327, -446, -353, -552, -581, -512, -599, -257, 22, 171, -122, 56, 16, 134, 88, 59, 3, 87, 13, 35, 50, 40, -17, -68, -257, -246, -301, -310, -335, -562, -506, -1005, -880, -875, -709, -299, 76, 94, 191, 161, 216, 162, 108, 43, 15, 3, 61, 4, 57, 9, 25, -32, -233, -268, -415, -342, -509, -477, -470, -696, -713, -580, -121, 525, 661, 680, 635, 514, 351, 257, 87, 27, 0, 17, 51, 3, 43, 83, 33, 104, 56, 124, 250, 441, 802, 1108, 1368, 1213, 1260, 1420, 1559, 2015, 1870, 1444, 1021, 710, 434, 220, 85, 1, 70, 56, 0, 62, 68, 22, 74, 133, 46, -8, -2, -20, -80, -52, 81, 198, 235, 376, 403, 597, 687, 551, 427, 241, 166, 118, 99, 22, 99, 51, 26, 98, 48, 92, 62, 30, 80, 5, 44, -7, 25, -36, -18, -47, -130, -88, -77, -49, -53, 32, 101, 95, 105, 38, 97, 22, 76, 22]];
    signal s[ndigits][n+1];
    component am = ArgMax(ndigits);
    for(var i=0; i<ndigits; i++){
        s[i][0] <== 0;
        for(var j=1; j<=n; j++){
            s[i][j] <== s[i][j-1] + A[i][j-1]*image[j-1];
        }
        am.in[i] <== s[i][n]+100000000;
        log(am.in[i]);
    }
    am.out ==> digit;
}

component main = DigitReader(784);

/* INPUT = {
  "image": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 36, 125, 191, 218, 255, 254, 254, 241, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 204, 249, 253, 253, 253, 253, 253, 253, 253, 250, 235, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 88, 241, 251, 253, 225, 142, 49, 12, 12, 12, 105, 253, 253, 111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 95, 225, 253, 167, 113, 14, 0, 0, 0, 0, 0, 16, 211, 253, 117, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 91, 238, 253, 170, 28, 0, 0, 0, 0, 0, 0, 0, 0, 150, 253, 117, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 98, 251, 218, 48, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 150, 253, 117, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 112, 253, 112, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 184, 242, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 45, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 67, 253, 240, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 27, 234, 248, 105, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 44, 157, 253, 132, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 189, 253, 203, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 156, 253, 246, 77, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 156, 253, 202, 68, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 156, 253, 226, 71, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 33, 33, 140, 163, 186, 253, 226, 38, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 81, 244, 253, 253, 253, 253, 253, 253, 253, 186, 70, 23, 0, 0, 22, 156, 77, 0, 0, 0, 0, 0, 0, 0, 0, 0, 80, 195, 253, 253, 253, 253, 253, 248, 234, 166, 248, 253, 253, 240, 150, 73, 144, 104, 51, 0, 0, 0, 0, 0, 0, 0, 0, 7, 248, 253, 253, 253, 253, 253, 242, 105, 0, 0, 107, 242, 253, 253, 253, 245, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 57, 250, 253, 253, 253, 247, 135, 21, 0, 0, 0, 0, 21, 117, 183, 183, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 121, 123, 176, 135, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
} */
